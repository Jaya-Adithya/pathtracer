import"./modulepreload-polyfill-B5Qt9EMX.js";import{au as R,av as k,a5 as T,aw as v,E as j,e as D,f as B,C as H,d as y,Z as b,aA as _,B as I}from"./MaterialBase-D0apYRZI.js";import{O as q}from"./OrbitControls-QPbjf6RX.js";import{H as z}from"./HDRLoader-QyionP9_.js";import{g as V}from"./lil-gui.module.min-BH_YJbPT.js";import{G as U}from"./GLTFLoader-CZoURFu4.js";import{D as K}from"./DRACOLoader-Y9SiWgF2.js";import{M as N}from"./meshopt_decoder.module-j6OW_3Rk.js";import{g as Y}from"./getScaledSettings-nzgggDDj.js";import{L as Z}from"./LoaderElement-DklLdAaa.js";import{D as J,M as E}from"./modelList-BunZDs6G.js";import{W as Q}from"./WebGLPathTracer-BkY-ibNS.js";import{P as X}from"./ParallelMeshBVHWorker-C6VKfx-V.js";import"./BufferGeometryUtils-B2ZswfaJ.js";import"./FogVolumeMaterial-BAhPC4Ul.js";import"./pcg.glsl-D_3-p9wz.js";import"./PathTracingRenderer-CqRsglCw.js";import"./ggx_functions.glsl-Bslli_qd.js";import"./GenerateMeshBVHWorker-CSNZTU94.js";const $="https://raw.githubusercontent.com/mrdoob/three.js/r150/examples/textures/equirectangular/royal_esplanade_1k.hdr";let t,a,w,e,r,S,g,C=null,l;const o={model:J,bounces:5,renderScale:1/window.devicePixelRatio,filterGlossyFactor:.5,tiles:1,multipleImportanceSampling:!0,enabled:!0,...Y()};ee();async function ee(){l=new Z,l.attach(document.body),a=new R({antialias:!0}),a.toneMapping=k,document.body.appendChild(a.domElement),t=new Q(a),t.tiles.set(o.tiles,o.tiles),t.setBVHWorker(new X),r=new T(75,window.innerWidth/window.innerHeight,.025,500),r.position.set(2.996,3.795,.697),w=new q(r,a.domElement),w.target.set(.311,1.13,.489),w.addEventListener("change",()=>t.updateCamera()),w.update(),e=new v,S=new v;const n=await new z().loadAsync($);n.mapping=j,e.background=n,e.environment=n;async function d(s){const m=E[s];if(!m||!m.url)return;C&&e.remove(C),l.setPercentage(0);const M=new K;M.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.7/");const O=await new U().setDRACOLoader(M).setMeshoptDecoder(N).loadAsync(m.url);M.dispose();const i=O.scene;m.postProcess&&m.postProcess(i),i.traverse(u=>{u.material&&(u.material.map=null)}),i.updateMatrixWorld(!0);const x=new I;x.setFromObject(i),i.position.y-=x.min.y,e.add(i),C=i,e.updateMatrixWorld(!0),await t.setSceneAsync(e,r,{onProgress:u=>l.setPercentage(u)}),l.setCredits(m.credit||"")}await d(o.model);const G=new D(3.5,3.5,.05,60),W=new B({color:new H(10066329),metalness:.2,roughness:.02}),P=new y(G,W);P.position.y=-.025,e.add(P),g=[];const f=new y(new D(.5,.5,.5,32),new b({color:16711680})),h=new y(new _(.3,.3,.3),new b({color:65280}));f.position.set(-1,0,1),h.position.set(1,0,-1),g.push(f,h),S.add(f,h),await t.setSceneAsync(e,r,{onProgress:s=>{l.setPercentage(s)}});const L=new V;L.add(o,"model",Object.keys(E).sort()).onChange(async s=>{await d(s)});const c=L.addFolder("Path Tracer");c.add(o,"tiles",1,4,1).onChange(s=>{t.tiles.set(s,s)}),c.add(o,"filterGlossyFactor",0,1).onChange(p),c.add(o,"bounces",1,15,1).onChange(p),c.add(o,"renderScale",.1,1).onChange(p),c.add(o,"multipleImportanceSampling").onChange(p),c.close(),p(),A(),window.addEventListener("resize",A),F()}function p(){t.filterGlossyFactor=o.filterGlossyFactor,t.bounces=o.bounces,t.renderScale=o.renderScale,t.multipleImportanceSampling=o.multipleImportanceSampling}function A(){a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(window.devicePixelRatio),r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),t.updateCamera()}const te=new b({colorWrite:!1});function oe(){for(let n=0;n<g.length;n++){const d=g[n];d.position.y=Math.sin(Date.now()*.001+n)}}function F(){requestAnimationFrame(F),oe(),t.renderSample();const n=a.autoClear,d=e.background;a.autoClear=!1,e.background=null,e.overrideMaterial=te,a.clearDepth(),a.render(e,r),e.overrideMaterial=null,e.background=d,a.render(S,r),a.autoClear=n,l.setSamples(t.samples,t.isCompiling)}
//# sourceMappingURL=overlay-Ddjhxakr.js.map
