{"version":3,"file":"materialBall-oK0aAfvr.js","sources":["../../src/materials/fullscreen/DenoiseMaterial.js","../../example/materialBall.js"],"sourcesContent":["import { NoBlending } from 'three';\r\nimport { MaterialBase } from '../MaterialBase.js';\r\n\r\nexport class DenoiseMaterial extends MaterialBase {\r\n\r\n\tconstructor( parameters ) {\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\tblending: NoBlending,\r\n\r\n\t\t\ttransparent: false,\r\n\r\n\t\t\tdepthWrite: false,\r\n\r\n\t\t\tdepthTest: false,\r\n\r\n\t\t\tdefines: {\r\n\r\n\t\t\t\tUSE_SLIDER: 0,\r\n\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\r\n\t\t\t\tsigma: { value: 5.0 },\r\n\t\t\t\tthreshold: { value: 0.03 },\r\n\t\t\t\tkSigma: { value: 1.0 },\r\n\r\n\t\t\t\tmap: { value: null },\r\n\t\t\t\topacity: { value: 1 },\r\n\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: /* glsl */`\r\n\r\n\t\t\t\tvarying vec2 vUv;\r\n\r\n\t\t\t\tvoid main() {\r\n\r\n\t\t\t\t\tvUv = uv;\r\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t`,\r\n\r\n\t\t\tfragmentShader: /* glsl */`\r\n\r\n\t\t\t\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\t\t\t\t//  Copyright (c) 2018-2019 Michele Morrone\r\n\t\t\t\t//  All rights reserved.\r\n\t\t\t\t//\r\n\t\t\t\t//  https://michelemorrone.eu - https://BrutPitt.com\r\n\t\t\t\t//\r\n\t\t\t\t//  me@michelemorrone.eu - brutpitt@gmail.com\r\n\t\t\t\t//  twitter: @BrutPitt - github: BrutPitt\r\n\t\t\t\t//\r\n\t\t\t\t//  https://github.com/BrutPitt/glslSmartDeNoise/\r\n\t\t\t\t//\r\n\t\t\t\t//  This software is distributed under the terms of the BSD 2-Clause license\r\n\t\t\t\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\n\t\t\t\tuniform sampler2D map;\r\n\r\n\t\t\t\tuniform float sigma;\r\n\t\t\t\tuniform float threshold;\r\n\t\t\t\tuniform float kSigma;\r\n\t\t\t\tuniform float opacity;\r\n\r\n\t\t\t\tvarying vec2 vUv;\r\n\r\n\t\t\t\t#define INV_SQRT_OF_2PI 0.39894228040143267793994605993439\r\n\t\t\t\t#define INV_PI 0.31830988618379067153776752674503\r\n\r\n\t\t\t\t// Parameters:\r\n\t\t\t\t//\t sampler2D tex\t - sampler image / texture\r\n\t\t\t\t//\t vec2 uv\t\t   - actual fragment coord\r\n\t\t\t\t//\t float sigma  >  0 - sigma Standard Deviation\r\n\t\t\t\t//\t float kSigma >= 0 - sigma coefficient\r\n\t\t\t\t//\t\t kSigma * sigma  -->  radius of the circular kernel\r\n\t\t\t\t//\t float threshold   - edge sharpening threshold\r\n\t\t\t\tvec4 smartDeNoise( sampler2D tex, vec2 uv, float sigma, float kSigma, float threshold ) {\r\n\r\n\t\t\t\t\tfloat radius = round( kSigma * sigma );\r\n\t\t\t\t\tfloat radQ = radius * radius;\r\n\r\n\t\t\t\t\tfloat invSigmaQx2 = 0.5 / ( sigma * sigma );\r\n\t\t\t\t\tfloat invSigmaQx2PI = INV_PI * invSigmaQx2;\r\n\r\n\t\t\t\t\tfloat invThresholdSqx2 = 0.5 / ( threshold * threshold );\r\n\t\t\t\t\tfloat invThresholdSqrt2PI = INV_SQRT_OF_2PI / threshold;\r\n\r\n\t\t\t\t\tvec4 centrPx = texture2D( tex, uv );\r\n\t\t\t\t\tcentrPx.rgb *= centrPx.a;\r\n\r\n\t\t\t\t\tfloat zBuff = 0.0;\r\n\t\t\t\t\tvec4 aBuff = vec4( 0.0 );\r\n\t\t\t\t\tvec2 size = vec2( textureSize( tex, 0 ) );\r\n\r\n\t\t\t\t\tvec2 d;\r\n\t\t\t\t\tfor ( d.x = - radius; d.x <= radius; d.x ++ ) {\r\n\r\n\t\t\t\t\t\tfloat pt = sqrt( radQ - d.x * d.x );\r\n\r\n\t\t\t\t\t\tfor ( d.y = - pt; d.y <= pt; d.y ++ ) {\r\n\r\n\t\t\t\t\t\t\tfloat blurFactor = exp( - dot( d, d ) * invSigmaQx2 ) * invSigmaQx2PI;\r\n\r\n\t\t\t\t\t\t\tvec4 walkPx = texture2D( tex, uv + d / size );\r\n\t\t\t\t\t\t\twalkPx.rgb *= walkPx.a;\r\n\r\n\t\t\t\t\t\t\tvec4 dC = walkPx - centrPx;\r\n\t\t\t\t\t\t\tfloat deltaFactor = exp( - dot( dC.rgba, dC.rgba ) * invThresholdSqx2 ) * invThresholdSqrt2PI * blurFactor;\r\n\r\n\t\t\t\t\t\t\tzBuff += deltaFactor;\r\n\t\t\t\t\t\t\taBuff += deltaFactor * walkPx;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn aBuff / zBuff;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvoid main() {\r\n\r\n\t\t\t\t\tgl_FragColor = smartDeNoise( map, vec2( vUv.x, vUv.y ), sigma, kSigma, threshold );\r\n\t\t\t\t\t#include <tonemapping_fragment>\r\n\t\t\t\t\t#include <colorspace_fragment>\r\n\t\t\t\t\t#include <premultiplied_alpha_fragment>\r\n\r\n\t\t\t\t\tgl_FragColor.a *= opacity;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t`\r\n\r\n\t\t} );\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n}\r\n","import {\r\n\tACESFilmicToneMapping,\r\n\tCustomBlending,\r\n\tScene,\r\n\tWebGLRenderer,\r\n\tVector3,\r\n} from 'three';\r\nimport { FullScreenQuad } from 'three/examples/jsm/postprocessing/Pass.js';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport { DenoiseMaterial, WebGLPathTracer } from '../src/index.js';\r\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\r\nimport { LoaderElement } from './utils/LoaderElement.js';\r\nimport { MaterialOrbSceneLoader } from './utils/MaterialOrbSceneLoader.js';\r\nimport { RectAreaLightUniformsLib } from 'three/examples/jsm/lights/RectAreaLightUniformsLib.js';\r\n\r\nconst CREDITS = 'Material orb model courtesy of USD Working Group';\r\n\r\nlet pathTracer, renderer, controls, denoiseQuad, material;\r\nlet camera, scene, loader;\r\n\r\nconst params = {\r\n\r\n\tmaterialProperties: {\r\n\t\tcolor: '#ffe6bd',\r\n\t\temissive: '#000000',\r\n\t\temissiveIntensity: 1,\r\n\t\troughness: 0,\r\n\t\tmetalness: 1,\r\n\t\tior: 1.495,\r\n\t\ttransmission: 0.0,\r\n\t\tthinFilm: false,\r\n\t\tattenuationColor: '#ffffff',\r\n\t\tattenuationDistance: 0.5,\r\n\t\topacity: 1.0,\r\n\t\tclearcoat: 0.0,\r\n\t\tclearcoatRoughness: 0.0,\r\n\t\tsheenColor: '#000000',\r\n\t\tsheenRoughness: 0.0,\r\n\t\tiridescence: 0.0,\r\n\t\tiridescenceIOR: 1.5,\r\n\t\tiridescenceThickness: 400,\r\n\t\tspecularColor: '#ffffff',\r\n\t\tspecularIntensity: 1.0,\r\n\t\tmatte: false,\r\n\t\tflatShading: false,\r\n\t\tcastShadow: true,\r\n\t},\r\n\r\n\tmultipleImportanceSampling: true,\r\n\tdenoiseEnabled: true,\r\n\tdenoiseSigma: 2.5,\r\n\tdenoiseThreshold: 0.1,\r\n\tdenoiseKSigma: 1.0,\r\n\tbounces: 5,\r\n\trenderScale: 1 / window.devicePixelRatio,\r\n\ttransmissiveBounces: 20,\r\n\tfilterGlossyFactor: 0.5,\r\n\ttiles: 3,\r\n};\r\n\r\nif ( window.location.hash.includes( 'transmission' ) ) {\r\n\r\n\tparams.materialProperties.metalness = 0.0;\r\n\tparams.materialProperties.roughness = 0.23;\r\n\tparams.materialProperties.transmission = 1.0;\r\n\tparams.materialProperties.color = '#ffffff';\r\n\r\n\tparams.bounces = 10;\r\n\tparams.tiles = 2;\r\n\r\n} else if ( window.location.hash.includes( 'iridescent' ) ) {\r\n\r\n\tparams.materialProperties.color = '#474747';\r\n\tparams.materialProperties.roughness = 0.25;\r\n\tparams.materialProperties.metalness = 1.0;\r\n\tparams.materialProperties.iridescence = 1.0;\r\n\tparams.materialProperties.iridescenceIOR = 2.2;\r\n\r\n} else if ( window.location.hash.includes( 'acrylic' ) ) {\r\n\r\n\tparams.materialProperties.color = '#ffffff';\r\n\tparams.materialProperties.roughness = 0;\r\n\tparams.materialProperties.metalness = 0;\r\n\tparams.materialProperties.transmission = 1.0;\r\n\tparams.materialProperties.attenuationDistance = 0.75;\r\n\tparams.materialProperties.attenuationColor = '#2a6dc6';\r\n\r\n\tparams.bounces = 20;\r\n\tparams.tiles = 3;\r\n\r\n}\r\n\r\n// adjust performance parameters for mobile\r\nconst aspectRatio = window.innerWidth / window.innerHeight;\r\nif ( aspectRatio < 0.65 ) {\r\n\r\n\tparams.bounces = Math.max( params.bounces, 6 );\r\n\tparams.renderScale *= 0.5;\r\n\tparams.tiles = 2;\r\n\tparams.multipleImportanceSampling = false;\r\n\r\n}\r\n\r\ninit();\r\n\r\nasync function init() {\r\n\r\n\tRectAreaLightUniformsLib.init();\r\n\r\n\tloader = new LoaderElement();\r\n\tloader.attach( document.body );\r\n\r\n\t// renderer\r\n\trenderer = new WebGLRenderer( { antialias: true } );\r\n\trenderer.toneMapping = ACESFilmicToneMapping;\r\n\trenderer.toneMappingExposure = 0.02;\r\n\tdocument.body.appendChild( renderer.domElement );\r\n\r\n\t// path tracer\r\n\tpathTracer = new WebGLPathTracer( renderer );\r\n\tpathTracer.tiles.set( params.tiles, params.tiles );\r\n\tpathTracer.textureSize.set( 2048, 2048 );\r\n\tpathTracer.renderToCanvasCallback = ( target, renderer, quad ) => {\r\n\r\n\t\tdenoiseQuad.material.sigma = params.denoiseSigma;\r\n\t\tdenoiseQuad.material.threshold = params.denoiseThreshold;\r\n\t\tdenoiseQuad.material.kSigma = params.denoiseKSigma;\r\n\t\tdenoiseQuad.material.opacity = quad.material.opacity;\r\n\r\n\t\tconst autoClear = renderer.autoClear;\r\n\t\tconst finalQuad = params.denoiseEnabled ? denoiseQuad : quad;\r\n\t\trenderer.autoClear = false;\r\n\t\tfinalQuad.material.map = target.texture;\r\n\t\tfinalQuad.render( renderer );\r\n\t\trenderer.autoClear = autoClear;\r\n\r\n\t};\r\n\r\n\t// denoiser\r\n\tdenoiseQuad = new FullScreenQuad( new DenoiseMaterial( {\r\n\t\tmap: null,\r\n\t\tblending: CustomBlending,\r\n\t\tpremultipliedAlpha: renderer.getContextAttributes().premultipliedAlpha,\r\n\t} ) );\r\n\r\n\tscene = new Scene();\r\n\r\n\twindow.SCENE = scene;\r\n\r\n\t// load assets\r\n\tconst orb = await new MaterialOrbSceneLoader().loadAsync();\r\n\r\n\t// scene initialization\r\n\tscene.add( orb.scene );\r\n\tcamera = orb.camera;\r\n\tmaterial = orb.material;\r\n\r\n\t// move camera to the scene\r\n\tscene.attach( camera );\r\n\tcamera.removeFromParent();\r\n\r\n\t// controls\r\n\tcontrols = new OrbitControls( camera, renderer.domElement );\r\n\tcontrols.addEventListener( 'change', () => pathTracer.updateCamera() );\r\n\r\n\t// shift target\r\n\tconst fwd = new Vector3( 0, 0, - 1 ).transformDirection( camera.matrixWorld ).normalize();\r\n\tcontrols.target.copy( camera.position ).addScaledVector( fwd, 25 );\r\n\tcontrols.update();\r\n\r\n\tloader.setPercentage( 1 );\r\n\tloader.setCredits( CREDITS );\r\n\r\n\tonParamsChange();\r\n\tonResize();\r\n\twindow.addEventListener( 'resize', onResize );\r\n\r\n\t// gui\r\n\tconst gui = new GUI();\r\n\tconst ptFolder = gui.addFolder( 'Path Tracer' );\r\n\tptFolder.add( params, 'multipleImportanceSampling' ).onChange( onParamsChange );\r\n\tptFolder.add( params, 'tiles', 1, 4, 1 ).onChange( value => {\r\n\r\n\t\tpathTracer.tiles.set( value, value );\r\n\r\n\t} );\r\n\tptFolder.add( params, 'filterGlossyFactor', 0, 1 ).onChange( onParamsChange );\r\n\tptFolder.add( params, 'bounces', 1, 30, 1 ).onChange( onParamsChange );\r\n\tptFolder.add( params, 'transmissiveBounces', 0, 40, 1 ).onChange( onParamsChange );\r\n\tptFolder.add( params, 'renderScale', 0.1, 1 ).onChange( onParamsChange );\r\n\r\n\tconst denoiseFolder = gui.addFolder( 'Denoising' );\r\n\tdenoiseFolder.add( params, 'denoiseEnabled' );\r\n\tdenoiseFolder.add( params, 'denoiseSigma', 0.01, 12.0 );\r\n\tdenoiseFolder.add( params, 'denoiseThreshold', 0.01, 1.0 );\r\n\tdenoiseFolder.add( params, 'denoiseKSigma', 0.0, 12.0 );\r\n\tdenoiseFolder.close();\r\n\r\n\tconst matFolder1 = gui.addFolder( 'Material' );\r\n\tmatFolder1.addColor( params.materialProperties, 'color' ).onChange( onParamsChange );\r\n\tmatFolder1.addColor( params.materialProperties, 'emissive' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'emissiveIntensity', 0.0, 50.0, 0.01 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'roughness', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'metalness', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'opacity', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'transmission', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'thinFilm', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'attenuationDistance', 0.05, 2.0 ).onChange( onParamsChange );\r\n\tmatFolder1.addColor( params.materialProperties, 'attenuationColor' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'ior', 0.9, 3.0 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'clearcoat', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'clearcoatRoughness', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.addColor( params.materialProperties, 'sheenColor' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'sheenRoughness', 0, 1 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'iridescence', 0.0, 1.0 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'iridescenceIOR', 0.1, 3.0 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'iridescenceThickness', 0.0, 1200.0 ).onChange( onParamsChange );\r\n\tmatFolder1.addColor( params.materialProperties, 'specularColor' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'specularIntensity', 0.0, 1.0 ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'matte' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'flatShading' ).onChange( onParamsChange );\r\n\tmatFolder1.add( params.materialProperties, 'castShadow' ).onChange( onParamsChange );\r\n\tmatFolder1.close();\r\n\r\n\tanimate();\r\n\r\n}\r\n\r\nfunction onResize() {\r\n\r\n\trenderer.setSize( window.innerWidth, window.innerHeight );\r\n\trenderer.setPixelRatio( window.devicePixelRatio );\r\n\tcamera.aspect = window.innerWidth / window.innerHeight;\r\n\tcamera.updateProjectionMatrix();\r\n\tpathTracer.updateCamera();\r\n\r\n}\r\n\r\nfunction onParamsChange() {\r\n\r\n\tconst materialProperties = params.materialProperties;\r\n\tmaterial.color.set( materialProperties.color );\r\n\tmaterial.emissive.set( materialProperties.emissive );\r\n\tmaterial.emissiveIntensity = materialProperties.emissiveIntensity;\r\n\tmaterial.metalness = materialProperties.metalness;\r\n\tmaterial.roughness = materialProperties.roughness;\r\n\tmaterial.transmission = materialProperties.transmission;\r\n\tmaterial.attenuationDistance = materialProperties.thinFilm ? Infinity : materialProperties.attenuationDistance;\r\n\tmaterial.attenuationColor.set( materialProperties.attenuationColor );\r\n\tmaterial.ior = materialProperties.ior;\r\n\tmaterial.opacity = materialProperties.opacity;\r\n\tmaterial.clearcoat = materialProperties.clearcoat;\r\n\tmaterial.clearcoatRoughness = materialProperties.clearcoatRoughness;\r\n\tmaterial.sheenColor.set( materialProperties.sheenColor );\r\n\tmaterial.sheenRoughness = materialProperties.sheenRoughness;\r\n\tmaterial.iridescence = materialProperties.iridescence;\r\n\tmaterial.iridescenceIOR = materialProperties.iridescenceIOR;\r\n\tmaterial.iridescenceThicknessRange = [ 0, materialProperties.iridescenceThickness ];\r\n\tmaterial.specularColor.set( materialProperties.specularColor );\r\n\tmaterial.specularIntensity = materialProperties.specularIntensity;\r\n\tmaterial.transparent = material.opacity < 1;\r\n\tmaterial.flatShading = materialProperties.flatShading;\r\n\r\n\tpathTracer.transmissiveBounces = params.transmissiveBounces;\r\n\tpathTracer.multipleImportanceSampling = params.multipleImportanceSampling;\r\n\tpathTracer.filterGlossyFactor = params.filterGlossyFactor;\r\n\tpathTracer.bounces = params.bounces;\r\n\tpathTracer.renderScale = params.renderScale;\r\n\r\n\t// note: custom properties\r\n\tmaterial.matte = materialProperties.matte;\r\n\tmaterial.castShadow = materialProperties.castShadow;\r\n\r\n\tpathTracer.updateMaterials();\r\n\tpathTracer.setScene( scene, camera );\r\n\r\n}\r\n\r\nfunction animate() {\r\n\r\n\trequestAnimationFrame( animate );\r\n\tpathTracer.renderSample();\r\n\tloader.setSamples( pathTracer.samples, pathTracer.isCompiling );\r\n\r\n}\r\n"],"names":["DenoiseMaterial","MaterialBase","parameters","NoBlending","CREDITS","pathTracer","renderer","controls","denoiseQuad","material","camera","scene","loader","params","aspectRatio","init","RectAreaLightUniformsLib","LoaderElement","WebGLRenderer","ACESFilmicToneMapping","WebGLPathTracer","target","quad","autoClear","finalQuad","FullScreenQuad","CustomBlending","Scene","orb","MaterialOrbSceneLoader","OrbitControls","fwd","Vector3","onParamsChange","onResize","gui","GUI","ptFolder","value","denoiseFolder","matFolder1","animate","materialProperties"],"mappings":"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"}